{"ast":null,"code":"import _asyncToGenerator from\"/home/jon/AppAcademy/portfolio/portfolio_1/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/home/jon/AppAcademy/portfolio/portfolio_1/frontend/node_modules/@babel/runtime/regenerator/index.js\";import{csrfFetch}from'./csrf';var ADD='user/ADD';var REMOVE='user/REMOVE';var setSessionUser=function setSessionUser(user){return{type:ADD,user:user};};var removeSessionUser=function removeSessionUser(){return{type:REMOVE};};export var login=function login(user){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var credential,password,response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:credential=user.credential,password=user.password;_context.next=3;return csrfFetch('/api/session',{method:'POST',body:JSON.stringify({credential:credential,password:password})});case 3:response=_context.sent;_context.next=6;return response.json();case 6:data=_context.sent;dispatch(setSessionUser(data.user));return _context.abrupt(\"return\",response);case 9:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var restoreUser=function restoreUser(){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return csrfFetch('/api/session');case 2:response=_context2.sent;_context2.next=5;return response.json();case 5:data=_context2.sent;dispatch(setSessionUser(data.user));return _context2.abrupt(\"return\",response);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var signup=function signup(user){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var username,email,password,response,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:username=user.username,email=user.email,password=user.password;_context3.next=3;return csrfFetch('/api/users',{method:'POST',body:JSON.stringify({username:username,email:email,password:password})});case 3:response=_context3.sent;_context3.next=6;return response.json();case 6:data=_context3.sent;dispatch(setSessionUser(data.user));return _context3.abrupt(\"return\",response);case 9:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var logout=function logout(){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return csrfFetch('/api/session',{method:'DELETE'});case 2:response=_context4.sent;dispatch(removeSessionUser());return _context4.abrupt(\"return\",response);case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};var initialState={user:null};var sessionReducer=function sessionReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;var newState;switch(action.type){case ADD:newState=Object.assign({},state);newState.user=action.user;return newState;;case REMOVE:newState=Object.assign({},state);newState.user=null;return newState;default:return state;}};export default sessionReducer;","map":{"version":3,"names":["csrfFetch","ADD","REMOVE","setSessionUser","user","type","removeSessionUser","login","dispatch","credential","password","method","body","JSON","stringify","response","json","data","restoreUser","signup","username","email","logout","initialState","sessionReducer","state","action","newState","Object","assign"],"sources":["/home/jon/AppAcademy/portfolio/portfolio_1/frontend/src/store/session.js"],"sourcesContent":["import { csrfFetch } from './csrf';\n\nconst ADD = 'user/ADD';\nconst REMOVE = 'user/REMOVE';\n\n\nconst setSessionUser = (user) => {\n  return {\n    type: ADD,\n    user\n  }\n};\n\nconst removeSessionUser = () => {\n  return {\n    type: REMOVE\n  }\n};\n\nexport const login = (user) => async dispatch => {\n  const { credential, password } = user\n  const response = await csrfFetch('/api/session',\n    {method:'POST',\n    body: JSON.stringify({\n      credential,\n      password\n    })\n  });\n\n    const data = await response.json();\n    dispatch(setSessionUser(data.user));\n    return response;\n}\n\nexport const restoreUser = () => async dispatch => {\n  const response = await csrfFetch('/api/session');\n  const data = await response.json();\n  dispatch(setSessionUser(data.user));\n  return response;\n};\n\nexport const signup = (user) => async (dispatch) => {\n  const { username, email, password } = user;\n  const response = await csrfFetch('/api/users', {\n    method: 'POST',\n    body: JSON.stringify({\n      username,\n      email,\n      password,\n    }),\n  });\n  const data = await response.json();\n  dispatch(setSessionUser(data.user));\n  return response;\n};\n\nexport const logout = () => async (dispatch) => {\n  const response = await csrfFetch('/api/session', {\n    method: 'DELETE'\n  })\n\n    dispatch(removeSessionUser());\n  return response;\n};\n\nconst initialState = { user: null };\n\nconst sessionReducer = (state = initialState, action) => {\n  let newState;\n  switch (action.type) {\n    case ADD:\n      newState = Object.assign({}, state);\n      newState.user = action.user;\n      return newState;\n    ;\n    case REMOVE:\n      newState = Object.assign({}, state);\n      newState.user = null;\n      return newState;\n    default:\n      return state;\n  }\n}\n\nexport default sessionReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}